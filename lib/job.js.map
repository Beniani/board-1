{"version":3,"sources":["job.es6"],"names":[],"mappings":";;;;;;;;sBAAoB,UAAU;;qBACiB,SAAS;;mBACxC,OAAO;;;;AAEvB,IAAI,IAAI,GAAG,SAAP,IAAI,GAAS,EAAE,CAAC;;AAEpB,IAAI,MAAM,GAAG,SAAT,MAAM,CAAI,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAK;AACzC,QAAI,IAAI,GAAG,WANP,gBAAgB,GAMK,CAAC;;;;;;AAM1B,QAAI,IAAI,GAAG,SAAP,IAAI,CAAI,IAAI,EAAK;AACjB,YAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,IAAI,AAAC,IAAI,IAAI,EAAE,CAAE,OAAO,EAAE,CAAC;;AAE5C,YAAI,OAAO,GAAG,MAAM,CAAC,OAAO,IAAI,EAAE,CAAC;;AAEnC,eAAO,CAAC,OAAO,CAAC,UAAC,MAAM,EAAK;AACxB,gBAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;;AAGrB,gBAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACnB,CAAC,CAAC;KACN,CAAC;;AAEF,gBA1BI,KAAK,EA0BH,MAAM,CAAC,QAAQ,IAAI,EAAE,EAAE,YAAM;AAC/B,YAAI;AACA,oBAAQ,CAAC,IAAI,CAAC,CAAC;SAClB,CAAC,OAAO,GAAG,EAAE,EACb;KACJ,CAAC,CAAC;;AAEH,YAAQ,CAAC,IAAI,CAAC,CAAC;CAClB,CAAC;;QAEM,MAAM,GAAN,MAAM","file":"job.js","sourcesContent":["import {every} from './runner';\nimport {createPushSocket as createSocket} from './queue';\nimport log from './log';\n\nlet noop = () => {};\n\nlet create = (config, delegate, callback) => {\n    let sock = createSocket();\n\n    // TODO: throw if target not specified.\n    // TODO: throw if target not in config.\n    // callback(new Error(), noop);\n\n    let send = (data) => {\n        data.ts = data.ts || (new Date()).getTime();\n\n        let targets = config.targets || [];\n\n        targets.forEach((target) => {\n            data.target = target;\n\n            //log(`sending:: '${JSON.stringify(data)}'`);\n            sock.send(data);\n        });\n    };\n\n    every(config.interval || 30, () => {\n        try {\n            delegate(send);\n        } catch (err) {\n        }\n    });\n\n    callback(null);\n};\n\nexport {create};\n"]}